import T from"./BkRmCysf.js";import{a as d,d as g,r as c,t as b,v as f,x as e,J as m,K as k,L as i,M as V,N as A,O as $,P as C,Q as U,R as _,y as N,z as M}from"./DJNiLHon.js";const v=async()=>{const r=d().$supabase,{data:a,error:n}=await r.from("tasks").select("*");return{data:a,error:n}},S=async o=>{const a=d().$supabase,{data:n,error:l}=await a.from("tasks").insert({title:o,status:"0"});return{data:n,error:l}},q=async o=>{const a=d().$supabase,{data:n,error:l}=await a.from("tasks").delete().eq("id",o);return{data:n,error:l}},B=async o=>{const a=d().$supabase,{data:n,error:l}=await a.from("tasks").update({title:o.title,status:o.status}).eq("id",o.id);return{data:n,error:l}},D=async o=>{const a=d().$supabase;if(o==="4"){const{data:n,error:l}=await a.from("tasks").select("*");return{data:n,error:l}}else{const{data:n,error:l}=await a.from("tasks").select("*").eq("status",o);return{data:n,error:l}}},z={class:"p-2 text-center"},H=["onUpdate:modelValue","onChange"],L={class:"bg-blue-500"},R=["onUpdate:modelValue","onChange"],E=["onClick"],J=g({__name:"index",setup(o){const r=c({title:"",status:"0"}),a=c("4");c("0");const n=c();v().then(u=>{n.value=u.data});const l=u=>{S(u).then(()=>{v().then(t=>{n.value=t.data})})},h=u=>{q(u).then(()=>{v().then(t=>{n.value=t.data})})},y=(u,t,x)=>{B({id:u,title:t,status:x}).then(()=>{v().then(s=>{n.value=s.data})})},w=u=>{D(u).then(t=>{n.value=t.data})};return(u,t)=>{const x=T;return b(),f("div",z,[t[8]||(t[8]=e("h1",null,"タスク一覧",-1)),e("form",{onSubmit:t[1]||(t[1]=V(s=>l(i(r).title),["prevent"])),class:"flex"},[m(e("input",{class:"input-text-primary w-4/5 mr-0.5",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>i(r).title=s)},null,512),[[k,i(r).title]]),t[4]||(t[4]=e("button",{type:"submit",class:"btn-primary w-1/5"},"追加",-1))],32),m(e("select",{name:"sort",id:"sort",onChange:t[2]||(t[2]=s=>w(i(a))),"onUpdate:modelValue":t[3]||(t[3]=s=>C(a)?a.value=s:null)},t[5]||(t[5]=[$('<option value="4">全て</option><option value="0">未着手</option><option value="1">作業中</option><option value="2">完了</option><option value="3">放置</option>',5)]),544),[[A,i(a)]]),e("table",null,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"id"),e("th",null,"タスク"),e("th",null,"ステータス")])],-1)),e("tbody",null,[(b(!0),f(U,null,_(i(n),s=>(b(),f("tr",{key:s.id},[e("td",null,N(s.id),1),e("td",null,[m(e("input",{type:"text","onUpdate:modelValue":p=>s.title=p,onChange:p=>y(s.id,s.title,s.status)},null,40,H),[[k,s.title]])]),e("td",L,[m(e("select",{name:"status",id:"status","onUpdate:modelValue":p=>s.status=p,onChange:p=>y(s.id,s.title,s.status)},t[6]||(t[6]=[e("option",{value:"0"},"未着手",-1),e("option",{value:"1"},"作業中",-1),e("option",{value:"2"},"完了",-1),e("option",{value:"3"},"放置",-1)]),40,R),[[A,s.status]])]),e("td",null,[e("button",{type:"button",onClick:()=>h(s.id)},[M(x,{name:"tabler:trash-x",size:"2em"})],8,E)])]))),128))])])])}}});export{J as default};
